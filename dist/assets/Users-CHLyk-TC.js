import{_ as H,m as W,c as k,r as D,a as m,o as p,b as l,q as $,t as n,d,u as s,i as M,w as v,f,g as y,E as g,e as G,D as u,n as N,G as K,F as P,k as Q,H as S}from"./index-D0Jc_NLw.js";import{u as X}from"./userStore-DIQUm4Gj.js";import{u as Y}from"./filterStore-BpegOwCG.js";const Z={class:"users-page"},ee={class:"header-row"},le={class:"page-title"},ae={class:"header-actions"},te={class:"filter-section"},se={class:"name-with-status"},de={class:"locker-location-cell"},oe={class:"user-cards mobile-cards"},re={class:"card-row data-row"},ie={class:"card-cell"},ce={class:"cell-value name-with-status"},ne={class:"card-cell"},ve={class:"cell-value"},ue={class:"card-row data-row"},pe={class:"card-cell"},be={class:"cell-value"},me={class:"card-cell"},fe={class:"cell-value locker-location-cell"},ye={class:"card-row data-row"},ge={class:"card-cell"},_e={class:"cell-value"},he={class:"card-cell"},we={class:"cell-value"},Ce={class:"card-row data-row"},ke={class:"card-cell action-cell",style:{"grid-column":"1 / -1"}},Se={class:"cell-value"},Ie=Object.assign({name:"Users"},{__name:"Users",setup(Ee){const I=W(),C=X(),E=Y(),B=k(()=>C.userList),_=D(""),h=k({get:()=>E.selectedCategory,set:t=>E.setCategory(t)}),O={backgroundColor:"#C7EDFF",color:"#000",fontWeight:"bold"},w=k(()=>{let t=[...B.value];if(h.value&&(t=t.filter(e=>e.category===h.value)),_.value){const e=_.value.toLowerCase();t=t.filter(a=>Object.entries(a).some(([r,o])=>r!=="category"&&o&&o.toString().toLowerCase().includes(e)))}return t}),A=D(null),j=()=>{A.value.click()},F=t=>{const e=t.target.files[0];if(!e)return;const a=new FileReader;e.name.endsWith(".csv")?(a.onload=r=>{const o=r.target.result,i=q(o);i&&(C.userList=i,t.target.value="")},a.readAsText(e)):e.name.endsWith(".json")?(a.onload=r=>{try{const o=JSON.parse(r.target.result);Array.isArray(o)?(C.userList=o,t.target.value=""):alert("Invalid JSON format. Expected an array.")}catch(o){alert("Error parsing JSON file: "+o.message)}},a.readAsText(e)):alert("Unsupported file format. Please upload CSV or JSON.")},q=t=>{try{const e=t.split(`
`).filter(c=>c.trim());if(e.length<2)return alert("CSV file is empty or has no data."),null;const a=e[0].split(",").map(c=>c.trim()),r=["name","employeeId","badgeId","locker","location","role","status"],o=r.filter(c=>!a.some(b=>b.toLowerCase()===c));if(o.length>0)return alert(`CSV file is missing required columns: ${o.join(", ")}`),null;const i=[];for(let c=1;c<e.length;c++){const b=e[c].split(","),U={};a.forEach((z,J)=>{var L;const V=z.toLowerCase();r.includes(V)&&(U[V]=((L=b[J])==null?void 0:L.trim())||"")}),i.push(U)}return i}catch(e){return alert("Error parsing CSV file: "+e.message),null}},R=()=>{const t=w.value,e=["name","employeeId","badgeId","locker","location","role","status"],a=[e.join(","),...t.map(c=>e.map(b=>c[b]||"").join(","))].join(`
`),r=new Blob([a],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(r),i=document.createElement("a");i.setAttribute("href",o),i.setAttribute("download","users_export.csv"),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)},T=()=>{I.push({name:"Users_all_edit",query:{mode:"add"}})},x=t=>{I.push({path:"/Users_all_edit",query:{mode:"edit",name:t.name,employeeId:t.employeeId,badgeId:t.badgeId,locker:t.locker,location:t.location,role:t.role,status:t.status,category:t.category||"",pin:t.pin||"",employmentStatus:t.employmentStatus||"active"}})};return(t,e)=>(p(),m("div",Z,[l("div",ee,[l("h1",le,"Users ("+n(w.value.length)+")",1),l("div",ae,[d(s(M),{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=a=>_.value=a),placeholder:"Search",style:{width:"200px"},clearable:""},null,8,["modelValue"]),d(s(y),{class:"import-btn",onClick:j},{default:v(()=>[...e[2]||(e[2]=[f(" Import File ",-1)])]),_:1}),d(s(y),{class:"export-btn",onClick:R},{default:v(()=>[...e[3]||(e[3]=[f(" Export File ",-1)])]),_:1}),d(s(y),{type:"primary",class:"add-user-btn",onClick:T},{default:v(()=>[...e[4]||(e[4]=[f("Add New User",-1)])]),_:1}),l("input",{ref_key:"fileInput",ref:A,type:"file",style:{display:"none"},accept:".csv,.json",onChange:F},null,544)])]),l("div",te,[d(s(G),{modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=a=>h.value=a),placeholder:"All Categories",clearable:"",style:{width:"200px"}},{default:v(()=>[d(s(g),{label:"All Categories",value:""}),d(s(g),{label:"A1",value:"A1"}),d(s(g),{label:"A2",value:"A2"}),d(s(g),{label:"A3",value:"A3"}),d(s(g),{label:"A4",value:"A4"})]),_:1},8,["modelValue"])]),(p(),$(s(K),{key:t.refreshKey,data:w.value,border:"","header-cell-style":O,class:"users-table desktop-table"},{default:v(()=>[d(s(u),{prop:"name",label:"Name"},{default:v(a=>[l("div",se,[(p(),m("svg",{class:N(["status-icon",a.row.employmentStatus==="active"?"status-active":"status-inactive"]),viewBox:"0 0 24 24",fill:"currentColor"},[...e[5]||(e[5]=[l("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"},null,-1)])],2)),l("span",null,n(a.row.name),1)])]),_:1}),d(s(u),{prop:"employeeId",label:"Employee ID"}),d(s(u),{prop:"badgeId",label:"Badge ID"}),d(s(u),{label:"Locker / Location"},{default:v(a=>[l("div",de,[l("div",null,n(a.row.locker),1),l("div",null,n(a.row.location),1)])]),_:1}),d(s(u),{prop:"role",label:"Role"}),d(s(u),{prop:"status",label:"Status"}),d(s(u),{label:"Operation",align:"center"},{default:v(a=>[d(s(y),{type:"primary",plain:"",class:"edit-btn",onClick:r=>x(a.row)},{default:v(()=>[...e[6]||(e[6]=[f(" Edit ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),l("div",oe,[(p(!0),m(P,null,Q(w.value,(a,r)=>(p(),m("div",{key:r,class:"user-card"},[e[12]||(e[12]=S('<div class="card-row header-row-card" data-v-bbd71255><div class="card-cell" data-v-bbd71255><div class="cell-label" data-v-bbd71255>Name</div></div><div class="card-divider-vertical" data-v-bbd71255></div><div class="card-cell" data-v-bbd71255><div class="cell-label" data-v-bbd71255>Employee ID</div></div></div>',1)),l("div",re,[l("div",ie,[l("div",ce,[(p(),m("svg",{class:N(["status-icon",a.employmentStatus==="active"?"status-active":"status-inactive"]),viewBox:"0 0 24 24",fill:"currentColor"},[...e[7]||(e[7]=[l("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"},null,-1)])],2)),l("span",null,n(a.name),1)])]),e[8]||(e[8]=l("div",{class:"card-divider-vertical"},null,-1)),l("div",ne,[l("div",ve,n(a.employeeId),1)])]),e[13]||(e[13]=S('<div class="card-row header-row-card" data-v-bbd71255><div class="card-cell" data-v-bbd71255><div class="cell-label" data-v-bbd71255>Badge ID</div></div><div class="card-divider-vertical" data-v-bbd71255></div><div class="card-cell" data-v-bbd71255><div class="cell-label" data-v-bbd71255>Locker / Location</div></div></div>',1)),l("div",ue,[l("div",pe,[l("div",be,n(a.badgeId),1)]),e[9]||(e[9]=l("div",{class:"card-divider-vertical"},null,-1)),l("div",me,[l("div",fe,[l("div",null,n(a.locker),1),l("div",null,n(a.location),1)])])]),e[14]||(e[14]=S('<div class="card-row header-row-card" data-v-bbd71255><div class="card-cell" data-v-bbd71255><div class="cell-label" data-v-bbd71255>Role</div></div><div class="card-divider-vertical" data-v-bbd71255></div><div class="card-cell" data-v-bbd71255><div class="cell-label" data-v-bbd71255>Status</div></div></div>',1)),l("div",ye,[l("div",ge,[l("div",_e,n(a.role),1)]),e[10]||(e[10]=l("div",{class:"card-divider-vertical"},null,-1)),l("div",he,[l("div",we,n(a.status),1)])]),e[15]||(e[15]=l("div",{class:"card-row header-row-card"},[l("div",{class:"card-cell",style:{"grid-column":"1 / -1"}},[l("div",{class:"cell-label"},"Operation")])],-1)),l("div",Ce,[l("div",ke,[l("div",Se,[d(s(y),{type:"primary",plain:"",class:"edit-btn-mobile",onClick:o=>x(a)},{default:v(()=>[...e[11]||(e[11]=[f(" Edit ",-1)])]),_:1},8,["onClick"])])])])]))),128))])]))}}),Ve=H(Ie,[["__scopeId","data-v-bbd71255"]]);export{Ve as default};
