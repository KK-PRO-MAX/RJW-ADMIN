import{_ as J,H as Q,r as k,c as N,o as X,v as Y,z as ee,a as S,b as E,d as i,e as a,t as p,u as t,j as le,w as r,E as c,f as R,g as f,h as y,M as _,N as ae,F as te,l as ie,O as U,m as A}from"./index-B_Ky5Mco.js";import{u as de}from"./deviceStore-Bz4IAwIE.js";import{u as se}from"./filterStore-BRLp2vDi.js";import"./device-p3qppuv_.js";import"./index-B9ygI19o.js";const ce={class:"device-management-page"},oe={class:"header-row"},re={class:"page-title"},ne={class:"header-actions"},ve={class:"filter-section"},ue={class:"device-cards mobile-cards"},pe={class:"card-row data-row"},_e={class:"card-cell"},me={class:"cell-value"},be={class:"card-cell"},fe={class:"cell-value"},ye={class:"card-cell"},he={class:"cell-value"},ge={class:"card-row data-row"},Ce={class:"card-cell"},De={class:"cell-value"},we={class:"card-cell"},ke={class:"cell-value"},Ae={class:"card-cell action-cell"},xe={class:"cell-value"},Ie={__name:"Devices",setup(Le){const O=Q(),v=de(),T=se(),x=k(""),m=k("All"),h=N({get:()=>T.selectedCategory,set:l=>T.setCategory(l)}),V=k(null),W=k(1),j={backgroundColor:"#C7EDFF",color:"#000",fontWeight:"bold"},g=N(()=>{const l=x.value.trim().toLowerCase();return v.deviceList.filter(e=>l?String(e.device_id).toLowerCase().includes(l)||String(e.device_name).toLowerCase().includes(l)||String(e.device_type).toLowerCase().includes(l)||e.device_nfc_code&&String(e.device_nfc_code).toLowerCase().includes(l):!0)});N(()=>`Devices (${g.value.length})`);const z=()=>{C()},Z=()=>{C()},q=()=>{C()},C=async()=>{try{const l={page:W.value};if(m.value&&m.value!=="All"){const o={iPhone:1,iPad:2,Laptop:3,"Android Phone":4,"Android Tablet":5,Zebra:6}[m.value];o!==void 0&&(l.device_type_id=o)}if(h.value){const e=parseInt(h.value,10);isNaN(e)||(l.locker_id=e)}await v.loadDeviceList(l),console.log("è®¾å¤‡åˆ—è¡¨å·²åŠ è½½:",v.deviceList)}catch(l){console.error("è®¾å¤‡åˆ—è¡¨åŠ è½½å¤±è´¥:",l)}},F=async()=>{console.log("ðŸ”„ Devices initializing data..."),await C()};X(async()=>{console.log("ðŸ”„ Devices onMounted - component mounted"),await F()}),Y(async()=>{console.log("ðŸ”„ Devices onActivated - component activated from cache"),await F()});const P=l=>{O.push({path:"/Devices_all_edit",query:{mode:"edit",id:l.id,device_id:l.device_id,device_name:l.device_name,device_type_id:l.device_type_id,device_nfc_code:l.device_nfc_code,cabinet_no:l.cabinet_no,locker_id:l.locker_id}})},H=()=>{var l;(l=V.value)==null||l.click()},K=async l=>{const e=l.target.files[0];if(!e)return;const o=new FileReader;o.onload=d=>{var s,b,n,$,M,B;try{const I=d.target.result;if(e.name.endsWith(".csv")){const L=I.split(`
`),D=[];for(let w=1;w<L.length;w++)if(L[w].trim()){const u=L[w].split(",");D.push({device_id:((s=u[0])==null?void 0:s.trim())||"",device_name:((b=u[1])==null?void 0:b.trim())||"",device_type_id:parseInt(((n=u[2])==null?void 0:n.trim())||"0"),device_nfc_code:parseInt((($=u[3])==null?void 0:$.trim())||"0"),cabinet_no:parseInt(((M=u[4])==null?void 0:M.trim())||"0"),locker_id:parseInt(((B=u[5])==null?void 0:B.trim())||"0")})}D.length>0&&(v.deviceList.length=0,v.deviceList.push(...D),A.success(`Successfully imported ${D.length} devices`))}else(e.name.endsWith(".xlsx")||e.name.endsWith(".xls"))&&A.warning("Excel file import requires the xlsx library. Please use CSV format or install the xlsx library.")}catch(I){console.error("Import failed:",I),A.error("File import failed, please check the file format")}},o.readAsText(e),l.target.value=""},G=()=>{const l="Device ID,Device Name,Device Type ID,Device NFC Code,Cabinet No,Locker ID",e=v.deviceList.map(n=>`${n.device_id},${n.device_name},${n.device_type_id},${n.device_nfc_code||""},${n.cabinet_no},${n.locker_id}`),o=[l,...e].join(`
`),d=new Blob([o],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),b=URL.createObjectURL(d);s.setAttribute("href",b),s.setAttribute("download",`devices_${new Date().getTime()}.csv`),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s),A.success("Device data exported successfully")};return(l,e)=>{const o=ee("router-link");return E(),S("div",ce,[i("div",oe,[i("h1",re,"Devices ("+p(g.value.length)+")",1),i("div",ne,[a(t(le),{modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=d=>x.value=d),placeholder:"Search",class:"search-input","prefix-icon":"el-icon-search",onInput:z},null,8,["modelValue"]),a(t(R),{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=d=>m.value=d),placeholder:"Select type",class:"device-type-select",onChange:Z},{default:r(()=>[a(t(c),{label:"All",value:"All"}),a(t(c),{label:"iPhone",value:"iPhone"}),a(t(c),{label:"iPad",value:"iPad"}),a(t(c),{label:"Laptop",value:"Laptop"}),a(t(c),{label:"Android Phone",value:"Android Phone"}),a(t(c),{label:"Android Tablet",value:"Android Tablet"}),a(t(c),{label:"Zebra",value:"Zebra"})]),_:1},8,["modelValue"]),a(t(y),{class:"import-btn",onClick:H},{default:r(()=>[...e[3]||(e[3]=[f("Import File",-1)])]),_:1}),i("input",{ref_key:"fileInput",ref:V,type:"file",accept:".csv,.xlsx,.xls",style:{display:"none"},onChange:K},null,544),a(t(y),{class:"export-btn",onClick:G},{default:r(()=>[...e[4]||(e[4]=[f("Export File",-1)])]),_:1}),a(o,{to:"/Devices_all_edit"},{default:r(()=>[a(t(y),{type:"primary",class:"add-device-btn"},{default:r(()=>[...e[5]||(e[5]=[f("Add New Device",-1)])]),_:1})]),_:1})])]),i("div",ve,[a(t(R),{modelValue:h.value,"onUpdate:modelValue":e[2]||(e[2]=d=>h.value=d),placeholder:"All Categories",clearable:"",style:{width:"200px"},onChange:q},{default:r(()=>[a(t(c),{label:"All Categories",value:""}),a(t(c),{label:"A1",value:"A1"}),a(t(c),{label:"A2",value:"A2"}),a(t(c),{label:"A3",value:"A3"}),a(t(c),{label:"A4",value:"A4"})]),_:1},8,["modelValue"])]),a(t(ae),{data:g.value,border:"","header-cell-style":j,class:"device-table desktop-table"},{default:r(()=>[a(t(_),{prop:"device_name",label:"Device Name"}),a(t(_),{prop:"device_id",label:"Device ID"}),a(t(_),{prop:"device_nfc_code",label:"Barcode or NFC*"}),a(t(_),{prop:"device_type",label:"Device Type"}),a(t(_),{prop:"cabinet_no",label:"Cabinet No"}),a(t(_),{label:"Operation",align:"center"},{default:r(d=>[a(t(y),{type:"primary",plain:"",class:"edit-btn",onClick:s=>P(d.row)},{default:r(()=>[...e[6]||(e[6]=[f(" Edit ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),i("div",ue,[(E(!0),S(te,null,ie(g.value,(d,s)=>(E(),S("div",{key:s,class:"device-card"},[e[12]||(e[12]=U('<div class="card-row header-row-card" data-v-4787c768><div class="card-cell" data-v-4787c768><div class="cell-label" data-v-4787c768>Device Name</div></div><div class="card-divider-vertical" data-v-4787c768></div><div class="card-cell" data-v-4787c768><div class="cell-label" data-v-4787c768>Device ID</div></div><div class="card-divider-vertical" data-v-4787c768></div><div class="card-cell" data-v-4787c768><div class="cell-label" data-v-4787c768>Barcode or NFC*</div></div></div>',1)),i("div",pe,[i("div",_e,[i("div",me,p(d.device_name),1)]),e[7]||(e[7]=i("div",{class:"card-divider-vertical"},null,-1)),i("div",be,[i("div",fe,p(d.device_id),1)]),e[8]||(e[8]=i("div",{class:"card-divider-vertical"},null,-1)),i("div",ye,[i("div",he,p(d.device_nfc_code),1)])]),e[13]||(e[13]=U('<div class="card-row header-row-card" data-v-4787c768><div class="card-cell" data-v-4787c768><div class="cell-label" data-v-4787c768>Device Type</div></div><div class="card-divider-vertical" data-v-4787c768></div><div class="card-cell" data-v-4787c768><div class="cell-label" data-v-4787c768>Cabinet No</div></div><div class="card-divider-vertical" data-v-4787c768></div><div class="card-cell" data-v-4787c768><div class="cell-label" data-v-4787c768>Action</div></div></div>',1)),i("div",ge,[i("div",Ce,[i("div",De,p(d.device_type),1)]),e[10]||(e[10]=i("div",{class:"card-divider-vertical"},null,-1)),i("div",we,[i("div",ke,p(d.cabinet_no),1)]),e[11]||(e[11]=i("div",{class:"card-divider-vertical"},null,-1)),i("div",Ae,[i("div",xe,[a(t(y),{type:"primary",plain:"",class:"edit-btn-mobile",onClick:b=>P(d)},{default:r(()=>[...e[9]||(e[9]=[f(" Edit ",-1)])]),_:1},8,["onClick"])])])])]))),128))])])}}},Fe=J(Ie,[["__scopeId","data-v-4787c768"]]);export{Fe as default};
