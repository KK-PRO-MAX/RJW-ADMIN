import{_ as U,v as M,r as A,g as R,a as W,c as j,b as O,e as p,d as t,t as Z,u as l,l as q,w as n,E as i,h as B,f as _,j as D,D as u,G as K,y as C}from"./index-DDRo-3-f.js";import{u as z}from"./deviceStore-5tlYC3UY.js";const H={class:"device-management-page"},J={class:"header-row"},Q={class:"page-title"},X={class:"header-actions"},Y={class:"filter-section"},ee={__name:"Devices",setup(te){const N=M(),v=z(),x=A(""),m=A("All"),y=A(""),T=A(null),S={backgroundColor:"#C7EDFF",color:"#000",fontWeight:"bold"},$=a=>{N.push({path:"/Devices_all_edit",query:{mode:"edit",deviceName:a.deviceName,deviceId:a.deviceId,deviceType:a.deviceType,assignedBay:a.assignedBay,deviceGroups:a.deviceGroups}})},G=()=>{var a;(a=T.value)==null||a.click()},P=async a=>{const e=a.target.files[0];if(!e)return;const d=new FileReader;d.onload=s=>{var o,b,r,E,I,L,V;try{const w=s.target.result;if(e.name.endsWith(".csv")){const h=w.split(`
`),le=h[0].split(","),f=[];for(let g=1;g<h.length;g++)if(h[g].trim()){const c=h[g].split(",");f.push({deviceName:((o=c[0])==null?void 0:o.trim())||"",deviceId:((b=c[1])==null?void 0:b.trim())||"",assignedBay:((r=c[2])==null?void 0:r.trim())||"",deviceType:((E=c[3])==null?void 0:E.trim())||"",deviceGroups:((I=c[4])==null?void 0:I.trim())||"",status:((L=c[5])==null?void 0:L.trim())||"Available",category:((V=c[6])==null?void 0:V.trim())||"A1"})}f.length>0&&(v.deviceList.length=0,v.deviceList.push(...f),C.success(`成功导入 ${f.length} 条设备数据`))}else(e.name.endsWith(".xlsx")||e.name.endsWith(".xls"))&&C.warning("Excel 文件导入需要安装 xlsx 库。请使用 CSV 格式或安装 xlsx 库。")}catch(w){console.error("导入失败:",w),C.error("文件导入失败，请检查文件格式")}},d.readAsText(e),a.target.value=""},F=()=>{const a=["Device Name,Device ID,Assigned Bay,Device Type,Device Groups,Status,Category"],e=v.deviceList.map(r=>`${r.deviceName},${r.deviceId},${r.assignedBay},${r.deviceType},${r.deviceGroups},${r.status},${r.category||"A1"}`),d=[a,...e].join(`
`),s=new Blob([d],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),b=URL.createObjectURL(s);o.setAttribute("href",b),o.setAttribute("download",`devices_${new Date().getTime()}.csv`),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o),C.success("设备数据导出成功")},k=R(()=>{const a=x.value.trim().toLowerCase();return v.deviceList.filter(e=>{const d=y.value?e.category===y.value:!0,s=m.value==="All"?!0:e.deviceType===m.value,o=a?e.deviceName.toLowerCase().includes(a)||e.deviceId.toLowerCase().includes(a)||e.deviceType.toLowerCase().includes(a)||e.deviceGroups.toLowerCase().includes(a):!0;return d&&s&&o})});return(a,e)=>{const d=W("router-link");return O(),j("div",H,[p("div",J,[p("h1",Q,"Devices ("+Z(k.value.length)+")",1),p("div",X,[t(l(q),{modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=s=>x.value=s),placeholder:"Search",class:"search-input","prefix-icon":"el-icon-search"},null,8,["modelValue"]),t(l(B),{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=s=>m.value=s),placeholder:"Select type",class:"device-type-select"},{default:n(()=>[t(l(i),{label:"All",value:"All"}),t(l(i),{label:"iPhone",value:"iPhone"}),t(l(i),{label:"iPad",value:"iPad"}),t(l(i),{label:"Laptop",value:"Laptop"}),t(l(i),{label:"Android Phone",value:"Android Phone"}),t(l(i),{label:"Android Tablet",value:"Android Tablet"}),t(l(i),{label:"Zebra",value:"Zebra"})]),_:1},8,["modelValue"]),t(l(D),{class:"import-btn",onClick:G},{default:n(()=>[...e[3]||(e[3]=[_("Import File",-1)])]),_:1}),p("input",{ref_key:"fileInput",ref:T,type:"file",accept:".csv,.xlsx,.xls",style:{display:"none"},onChange:P},null,544),t(l(D),{class:"export-btn",onClick:F},{default:n(()=>[...e[4]||(e[4]=[_("Export File",-1)])]),_:1}),t(d,{to:"/Devices_all_edit"},{default:n(()=>[t(l(D),{type:"primary",class:"add-device-btn"},{default:n(()=>[...e[5]||(e[5]=[_("Add New Device",-1)])]),_:1})]),_:1})])]),p("div",Y,[t(l(B),{modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=s=>y.value=s),placeholder:"All Categories",clearable:"",style:{width:"200px"}},{default:n(()=>[t(l(i),{label:"All Categories",value:""}),t(l(i),{label:"A1",value:"A1"}),t(l(i),{label:"A2",value:"A2"}),t(l(i),{label:"A3",value:"A3"}),t(l(i),{label:"A4",value:"A4"})]),_:1},8,["modelValue"])]),t(l(K),{data:k.value,border:"","header-cell-style":S,class:"device-table"},{default:n(()=>[t(l(u),{prop:"deviceName",label:"Device Name"}),t(l(u),{prop:"deviceId",label:"Device ID"}),t(l(u),{prop:"assignedBay",label:"Assigned Bay"}),t(l(u),{prop:"deviceType",label:"Device Type"}),t(l(u),{prop:"deviceGroups",label:"Device Groups"}),t(l(u),{prop:"status",label:"Status"}),t(l(u),{label:"Operation",align:"center"},{default:n(s=>[t(l(D),{type:"primary",plain:"",class:"edit-btn",onClick:o=>$(s.row)},{default:n(()=>[...e[6]||(e[6]=[_(" Edit ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])}}},oe=U(ee,[["__scopeId","data-v-9b821229"]]);export{oe as default};
